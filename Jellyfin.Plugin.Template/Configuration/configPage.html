<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Template</title>
</head>
<body>
    <div id="TemplateConfigPage" data-role="page" class="page type-interior pluginConfigurationPage" data-require="emby-input,emby-button,emby-select,emby-checkbox">
        <div data-role="content">
            <div class="content-primary">
                <form id="TemplateConfigForm">
				<!--
                    <div class="selectContainer">
                        <label class="selectLabel" for="Options">Several Options</label>
                        <select is="emby-select" id="Options" name="Options" class="emby-select-withcolor emby-select">
                            <option id="optOneOption" value="OneOption">One Option</option>
                            <option id="optAnotherOption" value="AnotherOption">Another Option</option>
                        </select>
                    </div>
                    <div class="inputContainer">
                        <label class="inputLabel inputLabelUnfocused" for="AnInteger">An Integer</label>
                        <input id="AnInteger" name="AnInteger" type="number" is="emby-input" min="0" />
                        <div class="fieldDescription">A Description</div>
                    </div>
                    <div class="checkboxContainer checkboxContainer-withDescription">
                        <label class="emby-checkbox-label">
                            <input id="TrueFalseSetting" name="TrueFalseCheckBox" type="checkbox" is="emby-checkbox" />
                            <span>A Checkbox</span>
                        </label>
                    </div>
					-->

					<!-- SMTP Server Details -->
					<div id="ServerDetails">
						<div class="inputContainer" id="SMTPServerAddress">
							<label class="inputLabel inputLabelUnfocused" for="SMTPServer">SMTP Server Address:</label>
							<input id="SMTPServer" name="SMTPServerName" type="text" is="emby-input" />
							<div class="fieldDescription">Server address of the SMTP server/service you want to use (i.e. smtp.gmail.com)</div>
						</div>
						<div class="inputContainer" id="SMTPPortNum">
							<label class="inputLabel inputLabelUnfocused" for="SMTPPort">SMTP Port:</label>
							<input id="SMTPPort" name="SMTPPortNum" type="number" is="emby-input" min="0" />
							<div class="fieldDescription">SMTP Port that the server/service listed above uses (i.e. 587)</div>
						</div>
						<div class="inputContainer" id="SMTPUsername">
							<label class="inputLabel inputLabelUnfocused" for="SMTPUser">SMTP Username:</label>
							<input id="SMTPUser" name="SMTPUsername" type="text" is="emby-input" />
							<div class="fieldDescription">Username/email that will be used to login to the SMTP server</div>
						</div>
						<div class="inputContainer" id="SMTPPassword">
							<label class="inputLabel inputLabelUnfocused" for="SMTPPass">SMTP Password:</label>
							<input id="SMTPPass" name="SMTPPassword" type="text" is="emby-input" />
							<div class="fieldDescription">Password that will be used to login to the SMTP server</div>
						</div>
						<!-- Save config button-->
						<div>
							<button is="emby-button" type="submit" class="raised button-submit block emby-button">
								<span>Save</span>
							</button>
						</div>
					</div>
                </form>
            </div>
        </div>
        <script type="text/javascript">
            var TemplateConfig = {
                pluginUniqueId: '60f478ab-2dd6-4ea0-af10-04d033f75979'
            };

            document.querySelector('#TemplateConfigPage')
                .addEventListener('pageshow', function() {
                    Dashboard.showLoadingMsg();
                    ApiClient.getPluginConfiguration(TemplateConfig.pluginUniqueId).then(function (config) {
						console.log("Populating Page..");
						console.log(document.querySelector('#SMTPPort').value);
                        document.querySelector('#SMTPServer').value = config.SMTPServer;
                        document.querySelector('#SMTPPort').value = config.SMTPPort;
                        document.querySelector('#SMTPUser').value = config.SMTPUser;
                        document.querySelector('#SMTPPass').value = config.SMTPPass;
                        Dashboard.hideLoadingMsg();
                    });
                });

            document.querySelector('#TemplateConfigForm')
                .addEventListener('submit', function(e) {
                Dashboard.showLoadingMsg();
                ApiClient.getPluginConfiguration(TemplateConfig.pluginUniqueId).then(function (config) {
                    config.SMTPServer = document.querySelector('#SMTPServer').value;
                    config.SMTPPort = document.querySelector('#SMTPPort').value;
                    config.SMTPUser = document.querySelector('#SMTPUser').value;
                    config.SMTPPass = document.querySelector('#SMTPPass').value;
					console.log("HERE: ",config);

                    ApiClient.updatePluginConfiguration(TemplateConfig.pluginUniqueId, config).then(function (result) {
                        Dashboard.processPluginConfigurationUpdateResult(result);
						console.log("RESULT: ", result);
                    });
                });

                e.preventDefault();
                return false;
            });
        </script>
    </div>
</body>
</html>
